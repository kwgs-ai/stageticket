<% @page_title = "予約確認" %>
<h1><%= @page_title %></h1>
<% if @errors.present? %>
  <% if @errors.instance_of?(Array) %>
    <div id="errors">
      <h3>エラーがあります。</h3>
      <ul>
        <% @errors.each do |msg| %>
          <li><%= msg %></li>
        <% end %>
      </ul>
    </div>
  <% else %>
    <h3><%= @errors %></h3>
  <% end %>
<% end %>
<% if @stage.present? %>
  <table class="list">
    <thead>
    <tr>
      <th>舞台タイトル</th>
      <th>団体名</th>
      <th>日時</th>
      <th>午前・午後</th>
      <th>本文</th>
      <th>残り座席数　S</th>
      <th>残り座席数　A</th>
      <th>残り座席数　B</th>
    </tr>
    </thead>
    <tbody>
    <tr>
      <td style="text-align: right">
        <%= @stage.title %></td>
      <td>
        <%= @stage.actor.name %>
      </td>
      <td><%= @stage.date %></td>
      <td><%= @stage.time %></td>
      <td><%= @stage.text %></td>
      <td><%= @stage.seats.where(reservation_id: nil).where('seat_type like ?', '%S%').count %></td>
      <td><%= @stage.seats.where(reservation_id: nil).where('seat_type like ?', '%A%').count %></td>
      <td><%= @stage.seats.where(reservation_id: nil).where('seat_type like ?', '%B%').count %></td>
    </tr>
    </tbody>
    </tbody>
  </table>
<% end %>
<%= form_for [@stage, @reservation] do |form| %>
  <h1>座席表</h1>
  <div class="check">
    <h2>まえ</h2>
    <div class="seat-out">
      <%= collection_check_boxes(:seat, :seat_type, @stage.seats, :seat_type, :seat_type, include_hidden: false, html_options: { class: "seat" }) do |b| %>
        <%= b.check_box disabled: @stage.seats.find_by(seat_type: b.text).reservation_id != nil %>
        <%= b.label %>
      <% end %>
    </div>
    <h2>うしろ</h2>
  </div>
  <div><%= form.submit %></div>
<% end %>
